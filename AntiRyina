local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local TextChatService = game:GetService("TextChatService")
local UserInputService = game:GetService("UserInputService")

local LocalPlayer = Players.LocalPlayer
local mouse = LocalPlayer:GetMouse()

local espTargets = {
    ["dyeuwuge"] = true,
    ["Bob54321W"] = true,
    ["QuesadBezzubik"] = true,
}

local keywords = {
    "medusa",
    "laser",
    "swap",
    "taser",
    "boogie"
}

local function containsKeyword(str)
    str = string.lower(str)
    for _, key in ipairs(keywords) do
        if string.find(str, key) then
            return true
        end
    end
    return false
end

local function sendChatMessage(text)
    if TextChatService.ChatVersion == Enum.ChatVersion.TextChatService then
        TextChatService.TextChannels.RBXGeneral:SendAsync(text)
        return
    end

    local chatRemote = ReplicatedStorage:FindFirstChild("DefaultChatSystemChatEvents")
    if chatRemote and chatRemote:FindFirstChild("SayMessageRequest") then
        chatRemote.SayMessageRequest:FireServer(text, "All")
    end
end

local function createESP(player)
    if not player.Character then return end
    local head = player.Character:FindFirstChild("Head")
    if not head then return end

    if head:FindFirstChild("ESP") then
        head.ESP:Destroy()
    end

    local billboard = Instance.new("BillboardGui")
    billboard.Name = "ESP"
    billboard.Size = UDim2.new(0, 100, 0, 25)
    billboard.Adornee = head
    billboard.AlwaysOnTop = true

    local text = Instance.new("TextLabel")
    text.Parent = billboard
    text.Size = UDim2.new(1, 0, 1, 0)
    text.BackgroundTransparency = 1
    text.Text = player.Name
    text.TextColor3 = Color3.fromRGB(0, 255, 0)
    text.TextStrokeTransparency = 0.5
    text.TextScaled = true

    billboard.Parent = head
end

local function checkESPPlayer(player)
    if espTargets[player.Name] then
        player.CharacterAdded:Connect(function(char)
            task.wait(1)
            createESP(player)
        end)
        if player.Character then
            task.wait(1)
            createESP(player)
        end
    end
end

for _, plr in Players:GetPlayers() do
    checkESPPlayer(plr)
end
Players.PlayerAdded:Connect(checkESPPlayer)



local currentTool = nil  

local function trackCharacter(char)
    char.ChildAdded:Connect(function(item)
        if item:IsA("Tool") and containsKeyword(item.Name) then
            item.Equipped:Connect(function()
                currentTool = item
            end)
            item.Unequipped:Connect(function()
                if currentTool == item then
                    currentTool = nil
                end
            end)
        end
    end)


    for _, item in ipairs(char:GetChildren()) do
        if item:IsA("Tool") and containsKeyword(item.Name) then
            item.Equipped:Connect(function()
                currentTool = item
            end)
            item.Unequipped:Connect(function()
                if currentTool == item then
                    currentTool = nil
                end
            end)
        end
    end
end

LocalPlayer.CharacterAdded:Connect(function(char)
    task.wait(0.3)
    trackCharacter(char)
end)
if LocalPlayer.Character then
    task.wait(0.3)
    trackCharacter(LocalPlayer.Character)
end

UserInputService.InputBegan:Connect(function(input, gp)
    if gp then return end
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        if currentTool then
            sendChatMessage("used item: " .. currentTool.Name)
        end
    end
end)
